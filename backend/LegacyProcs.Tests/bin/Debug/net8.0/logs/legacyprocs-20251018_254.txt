2025-10-18 23:27:53.920 -03:00 [INF] Iniciando ListarOrdensServicoQuery: {"Filtro":null,"Page":1,"PageSize":5,"$type":"ListarOrdensServicoQuery"} {"SourceContext":"LegacyProcs.Application.Behaviors.LoggingBehavior","ActionId":"d9b128c8-9b98-46a6-9524-f43a3f7bea8b","ActionName":"LegacyProcs.Controllers.OrdemServicoController.Get (LegacyProcs)","RequestId":"0HNGEMSD0AB4N","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.929 -03:00 [INF] Listando ordens de serviço. Filtro: null, Page: 1, PageSize: 5 {"SourceContext":"LegacyProcs.Application.Queries.ListarOrdensServicoQueryHandler","ActionId":"d9b128c8-9b98-46a6-9524-f43a3f7bea8b","ActionName":"LegacyProcs.Controllers.OrdemServicoController.Get (LegacyProcs)","RequestId":"0HNGEMSD0AB4N","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.929 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost/health - null null {"EventId":{"Id":1},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.930 -03:00 [ERR] Erro em ListarOrdensServicoQuery após 10ms: Services for database providers 'Microsoft.EntityFrameworkCore.SqlServer', 'Microsoft.EntityFrameworkCore.InMemory' have been registered in the service provider. Only a single database provider can be registered in a service provider. If possible, ensure that Entity Framework is managing its service provider by removing the call to 'UseInternalServiceProvider'. Otherwise, consider conditionally registering the database provider, or maintaining one service provider per database provider. {"SourceContext":"LegacyProcs.Application.Behaviors.LoggingBehavior","ActionId":"d9b128c8-9b98-46a6-9524-f43a3f7bea8b","ActionName":"LegacyProcs.Controllers.OrdemServicoController.Get (LegacyProcs)","RequestId":"0HNGEMSD0AB4N","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
System.InvalidOperationException: Services for database providers 'Microsoft.EntityFrameworkCore.SqlServer', 'Microsoft.EntityFrameworkCore.InMemory' have been registered in the service provider. Only a single database provider can be registered in a service provider. If possible, ensure that Entity Framework is managing its service provider by removing the call to 'UseInternalServiceProvider'. Otherwise, consider conditionally registering the database provider, or maintaining one service provider per database provider.
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.Initialize(IServiceProvider scopedProvider, DbContextOptions contextOptions, DbContext context)
   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()
   at Microsoft.EntityFrameworkCore.DbContext.get_Model()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityType()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.CheckState()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityQueryable()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.System.Linq.IQueryable.get_Provider()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at LegacyProcs.Infrastructure.Repositories.OrdemServicoRepository.GetPagedAsync(Int32 page, Int32 pageSize, String filtro) in C:\Users\pagam\OneDrive\Documentos\GitHub\Trabalho\TesteTimeLegado\backend\LegacyProcs\Infrastructure\Repositories\OrdemServicoRepository.cs:line 63
   at LegacyProcs.Application.Queries.ListarOrdensServicoQueryHandler.Handle(ListarOrdensServicoQuery request, CancellationToken cancellationToken) in C:\Users\pagam\OneDrive\Documentos\GitHub\Trabalho\TesteTimeLegado\backend\LegacyProcs\Application\Queries\ListarOrdensServicoQueryHandler.cs:line 31
   at LegacyProcs.Application.Behaviors.LoggingBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\pagam\OneDrive\Documentos\GitHub\Trabalho\TesteTimeLegado\backend\LegacyProcs\Application\Behaviors\LoggingBehavior.cs:line 28
2025-10-18 23:27:53.931 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost/api/ordemservico - application/json; charset=utf-8 67 {"EventId":{"Id":1},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.932 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost/api/tecnico - application/json; charset=utf-8 109 {"EventId":{"Id":1},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.933 -03:00 [WRN] Input sanitizado para /api/ordemservico de Unknown. Conteúdo potencialmente malicioso removido. {"SourceContext":"LegacyProcs.Infrastructure.Middleware.InputSanitizationMiddleware","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.933 -03:00 [WRN] Input sanitizado para /api/tecnico de Unknown. Conteúdo potencialmente malicioso removido. {"SourceContext":"LegacyProcs.Infrastructure.Middleware.InputSanitizationMiddleware","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.935 -03:00 [INF] Executing endpoint 'Health checks' {"EventId":{"Name":"ExecutingEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.936 -03:00 [ERR] Erro no health check do banco de dados {"SourceContext":"LegacyProcs.Infrastructure.HealthChecks.DatabaseHealthCheck","HealthCheckName":"database","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
System.InvalidOperationException: Services for database providers 'Microsoft.EntityFrameworkCore.SqlServer', 'Microsoft.EntityFrameworkCore.InMemory' have been registered in the service provider. Only a single database provider can be registered in a service provider. If possible, ensure that Entity Framework is managing its service provider by removing the call to 'UseInternalServiceProvider'. Otherwise, consider conditionally registering the database provider, or maintaining one service provider per database provider.
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.Initialize(IServiceProvider scopedProvider, DbContextOptions contextOptions, DbContext context)
   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()
   at Microsoft.EntityFrameworkCore.DbContext.get_InternalServiceProvider()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IInfrastructure<System.IServiceProvider>.get_Instance()
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService(IInfrastructure`1 accessor, Type serviceType)
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService[TService](IInfrastructure`1 accessor)
   at Microsoft.EntityFrameworkCore.Infrastructure.AccessorExtensions.GetService[TService](IInfrastructure`1 accessor)
   at Microsoft.EntityFrameworkCore.Infrastructure.DatabaseFacade.get_Dependencies()
   at Microsoft.EntityFrameworkCore.Infrastructure.DatabaseFacade.Microsoft.EntityFrameworkCore.Storage.IDatabaseFacadeDependenciesAccessor.get_Dependencies()
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.GetFacadeDependencies(DatabaseFacade databaseFacade)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.GetConnectionString(DatabaseFacade databaseFacade)
   at LegacyProcs.Infrastructure.HealthChecks.DatabaseHealthCheck.CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken) in C:\Users\pagam\OneDrive\Documentos\GitHub\Trabalho\TesteTimeLegado\backend\LegacyProcs\Infrastructure\HealthChecks\DatabaseHealthCheck.cs:line 49
2025-10-18 23:27:53.937 -03:00 [INF] Executing endpoint 'LegacyProcs.Controllers.OrdemServicoController.Post (LegacyProcs)' {"EventId":{"Name":"ExecutingEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.937 -03:00 [INF] Executing endpoint 'LegacyProcs.Controllers.TecnicoController.Post (LegacyProcs)' {"EventId":{"Name":"ExecutingEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.942 -03:00 [INF] Route matched with {action = "Post", controller = "OrdemServico"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(LegacyProcs.Controllers.DTOs.OrdemServicoCreateDto) on controller LegacyProcs.Controllers.OrdemServicoController (LegacyProcs). {"EventId":{"Id":102,"Name":"ControllerActionExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","ActionId":"7b9d0656-9fa0-4383-b7fc-87bb1ed64b43","ActionName":"LegacyProcs.Controllers.OrdemServicoController.Post (LegacyProcs)","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.942 -03:00 [INF] Route matched with {action = "Post", controller = "Tecnico"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(LegacyProcs.Controllers.DTOs.TecnicoCreateDto) on controller LegacyProcs.Controllers.TecnicoController (LegacyProcs). {"EventId":{"Id":102,"Name":"ControllerActionExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","ActionId":"6cbbc5e3-6de1-49cf-81af-bc2cecd7c4ed","ActionName":"LegacyProcs.Controllers.TecnicoController.Post (LegacyProcs)","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.943 -03:00 [ERR] Health check database with status "Unhealthy" completed after 7.204ms with message 'Erro na conexão: InvalidOperationException' {"EventId":{"Id":103,"Name":"HealthCheckEnd"},"SourceContext":"Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.945 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'. {"EventId":{"Id":1,"Name":"ObjectResultExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor","ActionId":"7b9d0656-9fa0-4383-b7fc-87bb1ed64b43","ActionName":"LegacyProcs.Controllers.OrdemServicoController.Post (LegacyProcs)","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.945 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'. {"EventId":{"Id":1,"Name":"ObjectResultExecuting"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor","ActionId":"6cbbc5e3-6de1-49cf-81af-bc2cecd7c4ed","ActionName":"LegacyProcs.Controllers.TecnicoController.Post (LegacyProcs)","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.946 -03:00 [INF] Executed endpoint 'Health checks' {"EventId":{"Id":1,"Name":"ExecutedEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.946 -03:00 [WRN] Resposta com erro 503 para /health de Unknown {"SourceContext":"LegacyProcs.Infrastructure.Middleware.SecurityHeadersMiddleware","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.946 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost/health - 503 null application/json 16.7275ms {"EventId":{"Id":2},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB52","RequestPath":"/health","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.960 -03:00 [INF] Executed action LegacyProcs.Controllers.OrdemServicoController.Post (LegacyProcs) in 17.644ms {"EventId":{"Id":105,"Name":"ActionExecuted"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.960 -03:00 [INF] Executed endpoint 'LegacyProcs.Controllers.OrdemServicoController.Post (LegacyProcs)' {"EventId":{"Id":1,"Name":"ExecutedEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.960 -03:00 [WRN] Resposta com erro 400 para /api/ordemservico de Unknown {"SourceContext":"LegacyProcs.Infrastructure.Middleware.SecurityHeadersMiddleware","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.961 -03:00 [INF] Executed action LegacyProcs.Controllers.TecnicoController.Post (LegacyProcs) in 17.9375ms {"EventId":{"Id":105,"Name":"ActionExecuted"},"SourceContext":"Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.961 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost/api/ordemservico - 400 null application/problem+json; charset=utf-8 29.449ms {"EventId":{"Id":2},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB54","RequestPath":"/api/ordemservico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.961 -03:00 [INF] Executed endpoint 'LegacyProcs.Controllers.TecnicoController.Post (LegacyProcs)' {"EventId":{"Id":1,"Name":"ExecutedEndpoint"},"SourceContext":"Microsoft.AspNetCore.Routing.EndpointMiddleware","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.961 -03:00 [WRN] Resposta com erro 400 para /api/tecnico de Unknown {"SourceContext":"LegacyProcs.Infrastructure.Middleware.SecurityHeadersMiddleware","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
2025-10-18 23:27:53.961 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost/api/tecnico - 400 null application/problem+json; charset=utf-8 29.3331ms {"EventId":{"Id":2},"SourceContext":"Microsoft.AspNetCore.Hosting.Diagnostics","RequestId":"0HNGEMSD0AB56","RequestPath":"/api/tecnico","Application":"LegacyProcs","Environment":"Production"}
