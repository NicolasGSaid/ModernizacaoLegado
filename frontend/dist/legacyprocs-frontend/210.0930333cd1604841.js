"use strict";(self.webpackChunklegacyprocs_frontend=self.webpackChunklegacyprocs_frontend||[]).push([[210],{5210:(q,R,s)=>{s.r(R),s.d(R,{OrdemServicoFormComponent:()=>De});var e=s(4438),n=s(177),p=s(9417),I=s(6467),G=s(9631),Y=s(8834),V=s(2798),_=s(6600),D=s(3980),O=s(6969);s(9888),s(6860),s(9969),s(8359),s(1413),s(9030),s(7786),s(7673),s(3726),s(1985),s(7336),s(9327),s(6939),s(9172),s(5558),s(5964),s(6354),s(8141),s(3236),s(8793),s(6697),s(9974),s(4360),s(5343),s(3703),s(1397),s(8750),s(1584),s(8203);const _e={provide:new e.nKC("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{const a=(0,e.WQX)(O.hJ);return()=>a.scrollStrategies.reposition()}}),deps:[O.hJ],useFactory:function ve(a){return()=>a.scrollStrategies.reposition()}};let be=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({providers:[_e],imports:[O.z_,_.Sy,_.yE,n.MD,D.Gj,_.Sy,_.yE]})}}return a})();var B=s(2242),H=s(5779);let Oe=(()=>{class a{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new e.bkB;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(t,i,o,l,c){this.el=t,this.ngModel=i,this.control=o,this.cd=l,this.config=c}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(t){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(t){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(t||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||a)(e.rXU(e.aKT),e.rXU(p.vS,8),e.rXU(p.vO,8),e.rXU(e.gRc),e.rXU(H.r1))};static \u0275dir=e.FsC({type:a,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(i,o){1&i&&e.bIt("input",function(c){return o.onInput(c)}),2&i&&e.AVh("p-filled",o.filled)("p-inputtextarea-resizable",o.autoResize)("p-variant-filled","filled"===o.variant||"filled"===o.config.inputStyle())},inputs:{autoResize:[2,"autoResize","autoResize",e.L39],variant:"variant"},outputs:{onResize:"onResize"},features:[e.GFd]})}return a})(),Se=(()=>{class a{static \u0275fac=function(i){return new(i||a)};static \u0275mod=e.$C({type:a});static \u0275inj=e.G2t({imports:[n.MD]})}return a})();var K=s(675),Q=s(1141),J=s(491),Ae=s(4183),Ee=s(8623),Ce=s(6356),U=function(a){return a.Pendente="Pendente",a.EmAndamento="Em Andamento",a.Concluida="Conclu\xedda",a}(U||{}),Z=s(8498);function Te(a,h){1&a&&(e.j41(0,"small",16),e.EFF(1," T\xedtulo \xe9 obrigat\xf3rio "),e.k0s())}function Me(a,h){1&a&&(e.j41(0,"small",16),e.EFF(1," M\xednimo 3 caracteres "),e.k0s())}function Fe(a,h){1&a&&(e.j41(0,"small",16),e.EFF(1," Descri\xe7\xe3o \xe9 obrigat\xf3ria "),e.k0s())}function Pe(a,h){if(1&a&&(e.j41(0,"div",17)(1,"span",18),e.EFF(2),e.k0s(),e.j41(3,"span",19),e.EFF(4),e.k0s()()),2&a){const t=h.$implicit;e.R7$(2),e.JRh(t.nome),e.R7$(2),e.JRh(t.especialidade)}}function Re(a,h){1&a&&(e.j41(0,"small",16),e.EFF(1," T\xe9cnico \xe9 obrigat\xf3rio "),e.k0s())}function Ie(a,h){if(1&a&&(e.j41(0,"div",3)(1,"label",20),e.EFF(2,"Status"),e.k0s(),e.nrm(3,"p-dropdown",21),e.k0s()),2&a){const t=e.XpG();e.R7$(3),e.Y8G("options",t.statusOptions)}}let De=(()=>{class a{constructor(){this.fb=(0,e.WQX)(p.ok),this.ordemServicoService=(0,e.WQX)(Ae.a),this.tecnicoService=(0,e.WQX)(Ee.n),this.notificationService=(0,e.WQX)(Ce.J),this.router=(0,e.WQX)(Z.Ix),this.route=(0,e.WQX)(Z.nX),this.statusOptions=Object.values(U),this.tecnicos=[]}ngOnInit(){this.form=this.fb.group({titulo:["",[p.k0.required,p.k0.minLength(3)]],descricao:["",[p.k0.required]],tecnico:["",[p.k0.required]],status:[U.Pendente]}),this.loadTecnicos();const t=this.route.snapshot.paramMap.get("id");t&&(this.ordemId=Number(t),this.loadOrdem())}loadTecnicos(){this.tecnicoService.getAll(1,100).subscribe({next:t=>{this.tecnicos=t.data.filter(i=>"Ativo"===i.status)},error:()=>{this.notificationService.error("Erro ao carregar t\xe9cnicos")}})}loadOrdem(){this.ordemServicoService.getById(this.ordemId).subscribe({next:t=>{this.form.patchValue(t)},error:()=>{this.notificationService.error("Erro ao carregar ordem de servi\xe7o")}})}onSubmit(){if(this.form.valid){const t=this.form.value;this.ordemId?(console.log("Atualizando ordem ID:",this.ordemId),console.log("Dados enviados:",JSON.stringify(t,null,2)),this.ordemServicoService.update(this.ordemId,t).subscribe({next:()=>{this.notificationService.success("Ordem de servi\xe7o atualizada com sucesso"),this.router.navigate(["/ordem-servico"])},error:i=>{console.error("Erro completo:",i),console.error("Detalhes do erro:",JSON.stringify(i.error,null,2));let o="Erro ao atualizar ordem de servi\xe7o";i.error?.errors?o=Object.values(i.error.errors).flat().join(", "):i.error?.message?o=i.error.message:i.message&&(o=i.message),this.notificationService.error(o)}})):(console.log("Criando nova ordem"),console.log("Dados enviados:",t),this.ordemServicoService.create(t).subscribe({next:()=>{this.notificationService.success("Ordem de servi\xe7o criada com sucesso"),this.router.navigate(["/ordem-servico"])},error:i=>{console.error("Erro completo:",i),this.notificationService.error(i?.error?.message||i?.message||"Erro ao criar ordem de servi\xe7o")}}))}else console.log("Formul\xe1rio inv\xe1lido:",this.form.errors),this.notificationService.warning("Por favor, preencha todos os campos obrigat\xf3rios")}onCancel(){this.router.navigate(["/ordem-servico"])}static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-ordem-servico-form"]],standalone:!0,features:[e.aNF],decls:28,vars:24,consts:[[1,"form-container"],[1,"form-header"],[1,"p-fluid",3,"ngSubmit","formGroup"],[1,"field"],["for","titulo",1,"required"],["id","titulo","type","text","pInputText","","formControlName","titulo","placeholder","Digite o t\xedtulo da ordem"],["class","p-error",4,"ngIf"],["for","descricao",1,"required"],["id","descricao","pInputTextarea","","formControlName","descricao","rows","4","placeholder","Descreva os detalhes da ordem de servi\xe7o"],["for","tecnico",1,"required"],["id","tecnico","formControlName","tecnico","optionLabel","nome","optionValue","nome","placeholder","Selecione um t\xe9cnico",3,"options","showClear"],["pTemplate","item"],["class","field",4,"ngIf"],[1,"form-actions"],["label","Cancelar","icon","pi pi-times","severity","secondary","type","button",3,"onClick","text"],["icon","pi pi-check","type","submit",3,"label","disabled"],[1,"p-error"],[1,"tecnico-item"],[1,"tecnico-nome"],[1,"tecnico-especialidade"],["for","status"],["id","status","formControlName","status","placeholder","Selecione o status",3,"options"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3),e.k0s()(),e.j41(4,"p-card")(5,"form",2),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",3)(7,"label",4),e.EFF(8,"T\xedtulo"),e.k0s(),e.nrm(9,"input",5),e.DNE(10,Te,2,0,"small",6)(11,Me,2,0,"small",6),e.k0s(),e.j41(12,"div",3)(13,"label",7),e.EFF(14,"Descri\xe7\xe3o"),e.k0s(),e.j41(15,"textarea",8),e.EFF(16,"        "),e.k0s(),e.DNE(17,Fe,2,0,"small",6),e.k0s(),e.j41(18,"div",3)(19,"label",9),e.EFF(20,"T\xe9cnico Respons\xe1vel"),e.k0s(),e.j41(21,"p-dropdown",10),e.DNE(22,Pe,5,2,"ng-template",11),e.k0s(),e.DNE(23,Re,2,0,"small",6),e.k0s(),e.DNE(24,Ie,4,1,"div",12),e.j41(25,"div",13)(26,"p-button",14),e.bIt("onClick",function(){return o.onCancel()}),e.k0s(),e.nrm(27,"p-button",15),e.k0s()()()()),2&i){let l,c,b,E,C,L,T,M,g,F;e.R7$(3),e.SpI("",o.ordemId?"Editar":"Nova"," Ordem de Servi\xe7o"),e.R7$(2),e.Y8G("formGroup",o.form),e.R7$(4),e.AVh("ng-invalid",(null==(l=o.form.get("titulo"))?null:l.invalid)&&(null==(l=o.form.get("titulo"))?null:l.touched))("ng-dirty",null==(c=o.form.get("titulo"))?null:c.touched),e.R7$(),e.Y8G("ngIf",(null==(b=o.form.get("titulo"))?null:b.hasError("required"))&&(null==(b=o.form.get("titulo"))?null:b.touched)),e.R7$(),e.Y8G("ngIf",(null==(E=o.form.get("titulo"))?null:E.hasError("minlength"))&&(null==(E=o.form.get("titulo"))?null:E.touched)),e.R7$(4),e.AVh("ng-invalid",(null==(C=o.form.get("descricao"))?null:C.invalid)&&(null==(C=o.form.get("descricao"))?null:C.touched))("ng-dirty",null==(L=o.form.get("descricao"))?null:L.touched),e.R7$(2),e.Y8G("ngIf",(null==(T=o.form.get("descricao"))?null:T.hasError("required"))&&(null==(T=o.form.get("descricao"))?null:T.touched)),e.R7$(4),e.AVh("ng-invalid",(null==(M=o.form.get("tecnico"))?null:M.invalid)&&(null==(M=o.form.get("tecnico"))?null:M.touched))("ng-dirty",null==(g=o.form.get("tecnico"))?null:g.touched),e.Y8G("options",o.tecnicos)("showClear",!0),e.R7$(2),e.Y8G("ngIf",(null==(F=o.form.get("tecnico"))?null:F.hasError("required"))&&(null==(F=o.form.get("tecnico"))?null:F.touched)),e.R7$(),e.Y8G("ngIf",o.ordemId),e.R7$(2),e.Y8G("text",!0),e.R7$(),e.Y8G("label",o.ordemId?"Atualizar":"Criar")("disabled",!o.form.valid)}},dependencies:[n.MD,n.bT,p.X1,p.qT,p.me,p.BC,p.cb,p.j4,p.JD,I.RG,G.fS,Y.Hl,V.Ve,be,B.u,B.S,Se,Oe,K.kr,K.ms,H.Ei,Q.tm,Q.$n,J.D,J.Z],styles:['.form-container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:0 auto;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.form-header[_ngcontent-%COMP%]{margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:2px solid #f0f0f0}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:600;color:var(--text-primary);letter-spacing:-.5px}  .p-card{border-radius:16px;box-shadow:0 4px 12px #0000000d;border:none}  .p-card .p-card-body{padding:2rem}.field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#495057;font-size:.938rem}.field[_ngcontent-%COMP%]   label.required[_ngcontent-%COMP%]:after{content:" *";color:#f44336}  .p-inputtext,   .p-inputtextarea,   .p-dropdown{border-radius:12px;border:2px solid #e0e0e0;transition:all .3s ease}  .p-inputtext:enabled:focus,   .p-inputtextarea:enabled:focus,   .p-dropdown:not(.p-disabled).p-focus{border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-primary-light)}  .p-inputtext.ng-invalid.ng-dirty,   .p-inputtextarea.ng-invalid.ng-dirty,   .p-dropdown.ng-invalid.ng-dirty{border-color:#f44336}  .p-inputtext::placeholder,   .p-inputtextarea::placeholder{color:#9e9e9e;font-style:italic}  .p-dropdown-panel{border-radius:12px;box-shadow:0 4px 12px #0000001a;margin-top:.5rem}.tecnico-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.tecnico-nome[_ngcontent-%COMP%]{font-weight:500;color:#212529}.tecnico-especialidade[_ngcontent-%COMP%]{font-size:.813rem;color:#6c757d}.p-error[_ngcontent-%COMP%]{display:block;margin-top:.25rem;font-size:.813rem;color:#f44336}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid #f0f0f0}  .p-button{border-radius:12px;font-weight:500;padding:.75rem 1.5rem;transition:all .3s ease;box-shadow:0 2px 8px #00000014}  .p-button:not(.p-button-text):hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001f}  .p-button.p-button-primary{background-color:var(--accent-primary)!important;border:none;color:#fff!important}  .p-button.p-button-primary:hover{background-color:var(--accent-primary-hover)!important}  .p-button.p-button-secondary.p-button-text{color:#6c757d}  .p-button.p-button-secondary.p-button-text:hover{background-color:#6c757d1a;color:#495057}  .p-button:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:1rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}  .p-card .p-card-body{padding:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.form-actions[_ngcontent-%COMP%]     .p-button{width:100%}}']})}}return a})()},491:(q,R,s)=>{s.d(R,{D:()=>A,Z:()=>X});var e=s(177),n=s(4438),p=s(5779),I=s(4420);const G=["*",[["p-header"]],[["p-footer"]]],Y=["*","p-header","p-footer"];function V(r,v){1&r&&n.eu8(0)}function _(r,v){if(1&r&&(n.j41(0,"div",8),n.SdG(1,1),n.DNE(2,V,1,0,"ng-container",6),n.k0s()),2&r){const d=n.XpG();n.R7$(2),n.Y8G("ngTemplateOutlet",d.headerTemplate)}}function D(r,v){1&r&&n.eu8(0)}function O(r,v){if(1&r&&(n.j41(0,"div",9),n.EFF(1),n.DNE(2,D,1,0,"ng-container",6),n.k0s()),2&r){const d=n.XpG();n.R7$(),n.SpI(" ",d.header," "),n.R7$(),n.Y8G("ngTemplateOutlet",d.titleTemplate)}}function S(r,v){1&r&&n.eu8(0)}function j(r,v){if(1&r&&(n.j41(0,"div",10),n.EFF(1),n.DNE(2,S,1,0,"ng-container",6),n.k0s()),2&r){const d=n.XpG();n.R7$(),n.SpI(" ",d.subheader," "),n.R7$(),n.Y8G("ngTemplateOutlet",d.subtitleTemplate)}}function f(r,v){1&r&&n.eu8(0)}function w(r,v){1&r&&n.eu8(0)}function x(r,v){if(1&r&&(n.j41(0,"div",11),n.SdG(1,2),n.DNE(2,w,1,0,"ng-container",6),n.k0s()),2&r){const d=n.XpG();n.R7$(2),n.Y8G("ngTemplateOutlet",d.footerTemplate)}}let X=(()=>{class r{el;header;subheader;set style(d){I.BF.equals(this._style(),d)||this._style.set(d)}styleClass;headerFacet;footerFacet;templates;headerTemplate;titleTemplate;subtitleTemplate;contentTemplate;footerTemplate;_style=(0,n.vPA)(null);constructor(d){this.el=d}ngAfterContentInit(){this.templates.forEach(d=>{switch(d.getType()){case"header":this.headerTemplate=d.template;break;case"title":this.titleTemplate=d.template;break;case"subtitle":this.subtitleTemplate=d.template;break;case"content":default:this.contentTemplate=d.template;break;case"footer":this.footerTemplate=d.template}})}getBlockableElement(){return this.el.nativeElement.children[0]}static \u0275fac=function(u){return new(u||r)(n.rXU(n.aKT))};static \u0275cmp=n.VBU({type:r,selectors:[["p-card"]],contentQueries:function(u,m,P){if(1&u&&(n.wni(P,p.Y9,5),n.wni(P,p.wi,5),n.wni(P,p.Ei,4)),2&u){let y;n.mGM(y=n.lsd())&&(m.headerFacet=y.first),n.mGM(y=n.lsd())&&(m.footerFacet=y.first),n.mGM(y=n.lsd())&&(m.templates=y)}},hostAttrs:[1,"p-element"],inputs:{header:"header",subheader:"subheader",style:"style",styleClass:"styleClass"},ngContentSelectors:Y,decls:9,vars:10,consts:[[3,"ngClass","ngStyle"],["class","p-card-header",4,"ngIf"],[1,"p-card-body"],["class","p-card-title",4,"ngIf"],["class","p-card-subtitle",4,"ngIf"],[1,"p-card-content"],[4,"ngTemplateOutlet"],["class","p-card-footer",4,"ngIf"],[1,"p-card-header"],[1,"p-card-title"],[1,"p-card-subtitle"],[1,"p-card-footer"]],template:function(u,m){1&u&&(n.NAR(G),n.j41(0,"div",0),n.DNE(1,_,3,1,"div",1),n.j41(2,"div",2),n.DNE(3,O,3,2,"div",3)(4,j,3,2,"div",4),n.j41(5,"div",5),n.SdG(6),n.DNE(7,f,1,0,"ng-container",6),n.k0s(),n.DNE(8,x,3,1,"div",7),n.k0s()()),2&u&&(n.HbH(m.styleClass),n.Y8G("ngClass","p-card p-component")("ngStyle",m._style()),n.BMQ("data-pc-name","card"),n.R7$(),n.Y8G("ngIf",m.headerFacet||m.headerTemplate),n.R7$(2),n.Y8G("ngIf",m.header||m.titleTemplate),n.R7$(),n.Y8G("ngIf",m.subheader||m.subtitleTemplate),n.R7$(3),n.Y8G("ngTemplateOutlet",m.contentTemplate),n.R7$(),n.Y8G("ngIf",m.footerFacet||m.footerTemplate))},dependencies:[e.YU,e.bT,e.T3,e.B3],styles:["@layer primeng{.p-card-header img{width:100%}}\n"],encapsulation:2,changeDetection:0})}return r})(),A=(()=>{class r{static \u0275fac=function(u){return new(u||r)};static \u0275mod=n.$C({type:r});static \u0275inj=n.G2t({imports:[e.MD,p.Gg]})}return r})()}}]);